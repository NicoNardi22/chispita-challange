import { GetServerSideProps } from "next";
import Head from "next/head";
import NavBar from "../lib/Navbar";
import type { NextPage } from "next";
import axios from "axios";
import type { HotelData } from "./api/hotels/availability";

interface Props {
  navUrls: {
    urls: string[];
  };
  hotelsInfo: HotelData[];
}

const Home: NextPage<Props> = ({ navUrls, hotelsInfo }) => {
  return (
    <div>
      <Head>
        <title>Chispita Challange</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main>
        <NavBar navUrls={navUrls} hotelsInfo={hotelsInfo}></NavBar>
      </main>
    </div>
  );
};

export const getServerSideProps: GetServerSideProps = async (context) => {
  const emptyUrls: { urls: Array<string> } = { urls: [""] };
  const emptyHotelsInfo: Array<HotelData> = [];

  //url from page/api
  try {
    const resUrls = await axios(`http://localhost:3000/api/nav`);
    const navUrls = await resUrls.data;

    const resHotels = await axios(
      `http://localhost:3000/api/hotels/availability`
    );
    const hotelsInfo: HotelData[] = await resHotels.data;

    return {
      props: { navUrls, hotelsInfo },
    };
  } catch (error) {
    console.error(error);
  }

  return {
    props: { emptyUrls, emptyHotelsInfo },
  };
};

export default Home;
